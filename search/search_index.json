{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"index.html","text":"Welcome to CustomProteinSearch # Figure 1: Overview of the CusProSe package functionalities CustomProteinSearch is a python package containing two independent but complementary programs whose overall objective is to help users to search for specific proteins of interest based on their domain composition: IterHMMBuild and ProSeCDA . IterHMMBuild is an iterative search method based on the hmmer program, the aim of which is to provide users with a representative HMM protein profile of interest constructed by an iterative enrichment process starting from a small initial set of related protein sequences. ProSeCDA is a tool that allows to search in a given protein database multiple proteins of interest defined by a user-specified set of domains.","title":"Home"},{"location":"index.html#welcome-to-customproteinsearch","text":"Figure 1: Overview of the CusProSe package functionalities CustomProteinSearch is a python package containing two independent but complementary programs whose overall objective is to help users to search for specific proteins of interest based on their domain composition: IterHMMBuild and ProSeCDA . IterHMMBuild is an iterative search method based on the hmmer program, the aim of which is to provide users with a representative HMM protein profile of interest constructed by an iterative enrichment process starting from a small initial set of related protein sequences. ProSeCDA is a tool that allows to search in a given protein database multiple proteins of interest defined by a user-specified set of domains.","title":"Welcome to CustomProteinSearch"},{"location":"ihb_introduction.html","text":"IterHMMBuild overall procedure # Figure 2: Pipeline overview of IterHMMBuild IterHMMBuild is an iterative search method based on the hmmer program, the aim of which is to provide users with a representative HMM protein profile of interest constructed by an iterative enrichment process starting from a small initial set of related protein sequences. The IterHMMBuild procedure starts building an HMM profile from either a set of related protein sequences or a single query sequence. This initial profile is then used to identify homologous sequences in any user-specified protein sequence database. If sequences are found, they are added to the initial query sequences and a new HMM profile model is built. This process is repeated until no new sequences are found (i.e. convergence is reached). Inputs # Two inputs are required for IterHMMBuild. The first input is either a fasta file with at least one protein sequence ( Figure 2 ) OR a directory location where multiple individual fasta files are stored ( Figure 1 ). In the first case, the output will contain an HMM profile representative of the sequences in the fasta file given as input; if a directory is given as input then the HMM profile in the output will be a concatenation of HMM profiles, each corresponding to the fasta files present in the directory. The second input is a fasta file of protein database used to enrich initial protein sequence(s) of interest. HMM building step # The HMM building is a two-step procedure: a multiple sequence alignment is performed on the input sequences using muscle and the hmmbuild command from hmmer is then used to build the HMM profile from this alignment. However, note that at the first iteration the usearch command is performed on the input sequences to ensure that thoses sequences share no more than 90% (default value) of identity. Sequence enrichment step # The previously built HMM profile is searched against the protein database given as input using the hmmsearch command from hmmer. All matching sequences with a E-values a less than 0.01 (default value) and an expected accuracy per residue of the alignment b above or equal to 0.6 (default value) are retrieved. Those sequences are then merged to the initial input sequences. To ensure that sequences are not redundant, usearch is applied with a threshold identity value of 0.90. Note a Both conditional and independent E-values from hmmer are evaluated b Please see the hmmer documentation for more details about the accuracy Convergence # Basically, the convergence is reached when the number of sequences at iteration i+1 (Nseq i+1 ) is equal to the number of sequences at iteration i (Nseq i ). However, Nseq i+1 can sometimes be below than Nseq i . Thus, to ensure that the pipeline does not run indefinitely, a counter is incremented each time the absolute difference between Nseq i+1 and Nseq i is less or equal to 1 (default value). The convergence is then also reached when the value of this counter is equal to 3 (default value). Outputs # An example output is as shown below: iterhmmbuild_2020-10-29_13-13-04/ \u251c\u2500\u2500 X.hmm \u251c\u2500\u2500 X_seed.clw \u251c\u2500\u2500 X_seed.fa \u251c\u2500\u2500 info.log \u251c\u2500\u2500 iter_1 \u2502 \u251c\u2500\u2500 X_enriched_nr.fasta \u2502 \u251c\u2500\u2500 X_nr.clw \u2502 \u251c\u2500\u2500 X_nr.domtblout \u2502 \u251c\u2500\u2500 X_nr.fa \u2502 \u2514\u2500\u2500 X_nr.hmm \u251c\u2500\u2500 ... \u2514\u2500\u2500 iter_6 \u251c\u2500\u2500 X_enriched_nr.clw \u251c\u2500\u2500 X_enriched_nr.domtblout \u251c\u2500\u2500 X_enriched_nr.fasta \u2514\u2500\u2500 X_enriched_nr.hmm The table below describes the content of the output directory: File name Description X.hmm Final HMM profile X_seed.fa Final sequences used to build X.hmm X_seed.clw Multiple alignment (clustal W format) of X_seed.fa info.log Log summary of the computation iter_1/X_nr.fa Non redundant sequences coming from usearch applied on the input X.fa (see IterHMMBuild procedure ) iter_1/X_nr.clw Multiple alignment of sequences in X_nr.fa iter_1/X_nr.hmm HMM profile built with X_nr.clw as input iter_1/X_nr.domtblout Output file of the hmmsearch command iter_1/X_enriched_nr.fasta Non redundant sequences coming from homologous sequences identified with hmmsearch and initial sequences in X.fa","title":"Overall procedure"},{"location":"ihb_introduction.html#iterhmmbuild-overall-procedure","text":"Figure 2: Pipeline overview of IterHMMBuild IterHMMBuild is an iterative search method based on the hmmer program, the aim of which is to provide users with a representative HMM protein profile of interest constructed by an iterative enrichment process starting from a small initial set of related protein sequences. The IterHMMBuild procedure starts building an HMM profile from either a set of related protein sequences or a single query sequence. This initial profile is then used to identify homologous sequences in any user-specified protein sequence database. If sequences are found, they are added to the initial query sequences and a new HMM profile model is built. This process is repeated until no new sequences are found (i.e. convergence is reached).","title":"IterHMMBuild overall procedure"},{"location":"ihb_introduction.html#inputs","text":"Two inputs are required for IterHMMBuild. The first input is either a fasta file with at least one protein sequence ( Figure 2 ) OR a directory location where multiple individual fasta files are stored ( Figure 1 ). In the first case, the output will contain an HMM profile representative of the sequences in the fasta file given as input; if a directory is given as input then the HMM profile in the output will be a concatenation of HMM profiles, each corresponding to the fasta files present in the directory. The second input is a fasta file of protein database used to enrich initial protein sequence(s) of interest.","title":"Inputs"},{"location":"ihb_introduction.html#hmm-building-step","text":"The HMM building is a two-step procedure: a multiple sequence alignment is performed on the input sequences using muscle and the hmmbuild command from hmmer is then used to build the HMM profile from this alignment. However, note that at the first iteration the usearch command is performed on the input sequences to ensure that thoses sequences share no more than 90% (default value) of identity.","title":"HMM building step"},{"location":"ihb_introduction.html#sequence-enrichment-step","text":"The previously built HMM profile is searched against the protein database given as input using the hmmsearch command from hmmer. All matching sequences with a E-values a less than 0.01 (default value) and an expected accuracy per residue of the alignment b above or equal to 0.6 (default value) are retrieved. Those sequences are then merged to the initial input sequences. To ensure that sequences are not redundant, usearch is applied with a threshold identity value of 0.90. Note a Both conditional and independent E-values from hmmer are evaluated b Please see the hmmer documentation for more details about the accuracy","title":"Sequence enrichment step"},{"location":"ihb_introduction.html#convergence","text":"Basically, the convergence is reached when the number of sequences at iteration i+1 (Nseq i+1 ) is equal to the number of sequences at iteration i (Nseq i ). However, Nseq i+1 can sometimes be below than Nseq i . Thus, to ensure that the pipeline does not run indefinitely, a counter is incremented each time the absolute difference between Nseq i+1 and Nseq i is less or equal to 1 (default value). The convergence is then also reached when the value of this counter is equal to 3 (default value).","title":"Convergence"},{"location":"ihb_introduction.html#outputs","text":"An example output is as shown below: iterhmmbuild_2020-10-29_13-13-04/ \u251c\u2500\u2500 X.hmm \u251c\u2500\u2500 X_seed.clw \u251c\u2500\u2500 X_seed.fa \u251c\u2500\u2500 info.log \u251c\u2500\u2500 iter_1 \u2502 \u251c\u2500\u2500 X_enriched_nr.fasta \u2502 \u251c\u2500\u2500 X_nr.clw \u2502 \u251c\u2500\u2500 X_nr.domtblout \u2502 \u251c\u2500\u2500 X_nr.fa \u2502 \u2514\u2500\u2500 X_nr.hmm \u251c\u2500\u2500 ... \u2514\u2500\u2500 iter_6 \u251c\u2500\u2500 X_enriched_nr.clw \u251c\u2500\u2500 X_enriched_nr.domtblout \u251c\u2500\u2500 X_enriched_nr.fasta \u2514\u2500\u2500 X_enriched_nr.hmm The table below describes the content of the output directory: File name Description X.hmm Final HMM profile X_seed.fa Final sequences used to build X.hmm X_seed.clw Multiple alignment (clustal W format) of X_seed.fa info.log Log summary of the computation iter_1/X_nr.fa Non redundant sequences coming from usearch applied on the input X.fa (see IterHMMBuild procedure ) iter_1/X_nr.clw Multiple alignment of sequences in X_nr.fa iter_1/X_nr.hmm HMM profile built with X_nr.clw as input iter_1/X_nr.domtblout Output file of the hmmsearch command iter_1/X_enriched_nr.fasta Non redundant sequences coming from homologous sequences identified with hmmsearch and initial sequences in X.fa","title":"Outputs"},{"location":"ihb_usage.html","text":"IterHMMBuild usage guideline # Tip To guide the user, input data examples can be found in `cusProSe-x.x.x/iterhmmbuild/datas/`: datas/ \u251c\u2500\u2500 inputs \u2502 \u251c\u2500\u2500 A.fa \u2502 \u251c\u2500\u2500 KS.fa \u2502 \u2514\u2500\u2500 PP.fa \u2514\u2500\u2500 mgg_70-15_8.fasta All fasta files in the inputs/ directory contain sequences of three different protein domains. There is also the *magnaporthe orizae* proteome ( mgg_70-15_8.fasta ) that will be used as the protein database for the examples below. Quick start examples # Build a single HMM profile # Command to build a single HMM profile from the magnaporthe orizae proteome and representative of the A domain sequences: iterhmmbuild -fa inputs/A.fa -protdb mgg_70-15_8.fasta Build an HMM profile database # Command to build an HMM profile database specific to the magnaporthe orizae proteome with each profiles representative of the domain sequences present in the directory `inputs/`: iterhmmbuild -fa inputs/ -protdb mgg_70-15_8.fasta Note Please note that the user can also create an HMM profile database from a set of individual HMM profiles through the command create_hmmdb . Those HMM profiles must be placed in a unique directory that is given as an input. For instance, let's say we have the following directory containing three HMM profiles: my_hmm_dir/ \u251c\u2500\u2500 A.hmm \u251c\u2500\u2500 KS.hmm \u2514\u2500\u2500 PP.hmm Then the following command will generate an HMM profile database (that is a simple concatenation of the three HMM profiles) called mydb.hmm in an output directory named databases/ : create_hmmdb -hmmdir my_hmm_dir/ -dbname mydb.hmm -outdir databases/ Command line and parameters # As illustrated by the commands above, two arguments are mandatory for IterHMMBuild: -fa and -protdb . The input following -fa can be either a fasta file with at least one protein sequence OR a directory location where multiple individual fasta files are stored. The former can be used when the user wants to build a single HMM profile representative of the sequence(s) given as input. The latter should be used when the user wants to build a set of HMM profiles concatenated into an HMM profile database, with each HMM profile being representative of each related fasta files present in the directory given as input. The input following -protdb is a fasta file of the protein database used to enrich initial protein sequence(s) of interest. Help about the usage of IterHMMBuild and its parameters can be shown with the following command: iterhmmbuild -h usage: iterhmmbuild [-h] -fa [FA] -protdb [PROTDB] [-name [NAME]] [-out [OUT]] [-id ID] [-cov COV] [-cval CVAL] [-ival IVAL] [-acc ACC] Iterative building of hmm profiles optional arguments: -h, --help show this help message and exit -fa [FA] Fasta file of sequence(s) used as first seed or directory containing such files -protdb [PROTDB] Sequences used to learn the hmm profile (fasta format) -name [NAME] Name for the HMM profile (fasta name by default). -out [OUT] Output directory -id ID Sequence identity threshold to remove redundancy in seeds'sequences (0.9) -cov COV Minimum percentage of coverage alignment between hmm hit and hmm profile (0.0) -cval CVAL hmmer conditional e-value cutoff (0.01) -ival IVAL hmmer independant e-value cutoff (0.01) -acc ACC hmmer mean probability of the alignment accuracy between each residues of the target and the corresponding hmm state (0.6) Output of IterHMMBuild # After running IterHMMBuild an output directory will be generated in the following generic format: iterhmmbuild_year-month-day_hour-min-sec/ Output from the generation of a single HMM profile # The output directory generated from the command run in the quick start examples will have the following architecture: iterhmmbuild_2020-10-29_13-13-04/ \u251c\u2500\u2500 A.hmm \u251c\u2500\u2500 A_seed.clw \u251c\u2500\u2500 A_seed.fa \u251c\u2500\u2500 info.log \u251c\u2500\u2500 iter_1/ \u251c\u2500\u2500 iter_2/ \u251c\u2500\u2500 ... \u2514\u2500\u2500 iter_6/ The three main files of interest are: A.hmm Final HMM profile A.seed.clw Final sequences used to build A.hmm A.seed.fa Multiple alignment (clustal W format) of A_seed.fa info.log is a log summary of the computation. The subdirectories iter_i/ contain files obtained at each iteration and are described in section Overall procedure . Output from the generation of an HMM profile database # The output directory generated from the command run in the quick start examples will be a list of subdirectories such as the output described above. You will find at its root the file hmm_database.hmm , a concatenation of the HMM profiles of protein domains used as inputs. iterhmmbuild_2021-03-02_12-39-38 \u251c\u2500\u2500 hmm_database.hmm \u251c\u2500\u2500 info.log \u251c\u2500\u2500 A \u2502 \u251c\u2500\u2500 A.hmm \u2502 \u251c\u2500\u2500 A_seed.clw \u2502 \u2514\u2500\u2500 A_seed.fa \u251c\u2500\u2500 KS \u2502 \u251c\u2500\u2500 KS.hmm \u2502 \u251c\u2500\u2500 KS_seed.clw \u2502 \u2514\u2500\u2500 KS_seed.fa \u2514\u2500\u2500 PP \u251c\u2500\u2500 PP.hmm \u251c\u2500\u2500 PP_seed.clw \u2514\u2500\u2500 PP_seed.fa","title":"Usage guideline"},{"location":"ihb_usage.html#iterhmmbuild-usage-guideline","text":"Tip To guide the user, input data examples can be found in `cusProSe-x.x.x/iterhmmbuild/datas/`: datas/ \u251c\u2500\u2500 inputs \u2502 \u251c\u2500\u2500 A.fa \u2502 \u251c\u2500\u2500 KS.fa \u2502 \u2514\u2500\u2500 PP.fa \u2514\u2500\u2500 mgg_70-15_8.fasta All fasta files in the inputs/ directory contain sequences of three different protein domains. There is also the *magnaporthe orizae* proteome ( mgg_70-15_8.fasta ) that will be used as the protein database for the examples below.","title":"IterHMMBuild usage guideline"},{"location":"ihb_usage.html#quick-start-examples","text":"","title":"Quick start examples"},{"location":"ihb_usage.html#build-a-single-hmm-profile","text":"Command to build a single HMM profile from the magnaporthe orizae proteome and representative of the A domain sequences: iterhmmbuild -fa inputs/A.fa -protdb mgg_70-15_8.fasta","title":"Build a single HMM profile"},{"location":"ihb_usage.html#build-an-hmm-profile-database","text":"Command to build an HMM profile database specific to the magnaporthe orizae proteome with each profiles representative of the domain sequences present in the directory `inputs/`: iterhmmbuild -fa inputs/ -protdb mgg_70-15_8.fasta Note Please note that the user can also create an HMM profile database from a set of individual HMM profiles through the command create_hmmdb . Those HMM profiles must be placed in a unique directory that is given as an input. For instance, let's say we have the following directory containing three HMM profiles: my_hmm_dir/ \u251c\u2500\u2500 A.hmm \u251c\u2500\u2500 KS.hmm \u2514\u2500\u2500 PP.hmm Then the following command will generate an HMM profile database (that is a simple concatenation of the three HMM profiles) called mydb.hmm in an output directory named databases/ : create_hmmdb -hmmdir my_hmm_dir/ -dbname mydb.hmm -outdir databases/","title":"Build an HMM profile database"},{"location":"ihb_usage.html#command-line-and-parameters","text":"As illustrated by the commands above, two arguments are mandatory for IterHMMBuild: -fa and -protdb . The input following -fa can be either a fasta file with at least one protein sequence OR a directory location where multiple individual fasta files are stored. The former can be used when the user wants to build a single HMM profile representative of the sequence(s) given as input. The latter should be used when the user wants to build a set of HMM profiles concatenated into an HMM profile database, with each HMM profile being representative of each related fasta files present in the directory given as input. The input following -protdb is a fasta file of the protein database used to enrich initial protein sequence(s) of interest. Help about the usage of IterHMMBuild and its parameters can be shown with the following command: iterhmmbuild -h usage: iterhmmbuild [-h] -fa [FA] -protdb [PROTDB] [-name [NAME]] [-out [OUT]] [-id ID] [-cov COV] [-cval CVAL] [-ival IVAL] [-acc ACC] Iterative building of hmm profiles optional arguments: -h, --help show this help message and exit -fa [FA] Fasta file of sequence(s) used as first seed or directory containing such files -protdb [PROTDB] Sequences used to learn the hmm profile (fasta format) -name [NAME] Name for the HMM profile (fasta name by default). -out [OUT] Output directory -id ID Sequence identity threshold to remove redundancy in seeds'sequences (0.9) -cov COV Minimum percentage of coverage alignment between hmm hit and hmm profile (0.0) -cval CVAL hmmer conditional e-value cutoff (0.01) -ival IVAL hmmer independant e-value cutoff (0.01) -acc ACC hmmer mean probability of the alignment accuracy between each residues of the target and the corresponding hmm state (0.6)","title":"Command line and parameters"},{"location":"ihb_usage.html#output-of-iterhmmbuild","text":"After running IterHMMBuild an output directory will be generated in the following generic format: iterhmmbuild_year-month-day_hour-min-sec/","title":"Output of IterHMMBuild"},{"location":"ihb_usage.html#output-from-the-generation-of-a-single-hmm-profile","text":"The output directory generated from the command run in the quick start examples will have the following architecture: iterhmmbuild_2020-10-29_13-13-04/ \u251c\u2500\u2500 A.hmm \u251c\u2500\u2500 A_seed.clw \u251c\u2500\u2500 A_seed.fa \u251c\u2500\u2500 info.log \u251c\u2500\u2500 iter_1/ \u251c\u2500\u2500 iter_2/ \u251c\u2500\u2500 ... \u2514\u2500\u2500 iter_6/ The three main files of interest are: A.hmm Final HMM profile A.seed.clw Final sequences used to build A.hmm A.seed.fa Multiple alignment (clustal W format) of A_seed.fa info.log is a log summary of the computation. The subdirectories iter_i/ contain files obtained at each iteration and are described in section Overall procedure .","title":"Output from the generation of a single HMM profile"},{"location":"ihb_usage.html#output-from-the-generation-of-an-hmm-profile-database","text":"The output directory generated from the command run in the quick start examples will be a list of subdirectories such as the output described above. You will find at its root the file hmm_database.hmm , a concatenation of the HMM profiles of protein domains used as inputs. iterhmmbuild_2021-03-02_12-39-38 \u251c\u2500\u2500 hmm_database.hmm \u251c\u2500\u2500 info.log \u251c\u2500\u2500 A \u2502 \u251c\u2500\u2500 A.hmm \u2502 \u251c\u2500\u2500 A_seed.clw \u2502 \u2514\u2500\u2500 A_seed.fa \u251c\u2500\u2500 KS \u2502 \u251c\u2500\u2500 KS.hmm \u2502 \u251c\u2500\u2500 KS_seed.clw \u2502 \u2514\u2500\u2500 KS_seed.fa \u2514\u2500\u2500 PP \u251c\u2500\u2500 PP.hmm \u251c\u2500\u2500 PP_seed.clw \u2514\u2500\u2500 PP_seed.fa","title":"Output from the generation of an HMM profile database"},{"location":"installation.html","text":"Installation # Note CusProSe requires a python version >= 3.7 External dependencies # CusProSe relies on three external tools: hmmer, muscle and usearch. The first two can be easily installed from the following commands: hmmer (tested with version 3.3) sudo apt install hmmer muscle (tested with version 3.8.1551) sudo apt install muscle For usearch, you first need to download it here: usearch (tested with version v10.0.240) Next, you will have to rename it and make it accessible from anywhere in your system: # rename to usearch mv usearchXX.X.XXX_i86xxxx.gz usearch # make usearch executable chmod +x usearch # make usearch easily accessible mkdir ~/bin mv usearch ~/bin Finally, copy the following line in your .bashrc file (or .bash_profile for macos users) export PATH=$PATH:~/bin Create an isolated environment # Although not indispensable, this step is highly recommended (it will allow you to work on different projects avoiding potential conflicts between different versions of some python libraries). Install virtualenv # python3 -m pip install virtualenv Create a virtual python3 environment # virtualenv -p python3 my_env Activate the created environment # source my_env/bin/activate Once activated, any python library you'll install using pip will be installed solely in this isolated environment. Every time you'll need to work with libraries installed in this environment (i.e. work on your project), you'll have to activate it. Once you're done working on your project, simply type deactivate to exit the environment. Download and install the latest release of CusProSe # Click here for the latest release: Uncompress the archive # If you downloaded the .zip file: unzip cusProSe-x.x.x.zip If you downloaded the .tar.gz file: tar xzvf cusProSe-x.x.x.tar.gz Go to the cusProSe directory # cd cusProSe-x.x.x/ Install CusProSe on your virtual environment # Make sure your virtual environment is activated and type the following command: python setup.py install or pip install . Note If the installation successfully worked, then typing: iterhmmbuild should display: usage: iterhmmbuild [-h] -fa [FA] -protdb [PROTDB] [-name [NAME]] [-out [OUT]] [-id ID] [-cov COV] [-cval CVAL] [-ival IVAL] [-acc ACC] prosecda should display: usage: prosecda [-h] -proteome [PROTEOME] -hmmdb [HMMDB] -rules [RULES] [-out [OUT]] [-cov COV] [-cval CVAL] [-ival IVAL] [-score SCORE] [-acc ACC] [-pdf] create_hmmdb should display: usage: create_hmmdb [-h] -hmmdir [HMMDIR] [-dbname [DBNAME]] [-outdir [OUTDIR]]","title":"Installation"},{"location":"installation.html#installation","text":"Note CusProSe requires a python version >= 3.7","title":"Installation"},{"location":"installation.html#external-dependencies","text":"CusProSe relies on three external tools: hmmer, muscle and usearch. The first two can be easily installed from the following commands: hmmer (tested with version 3.3) sudo apt install hmmer muscle (tested with version 3.8.1551) sudo apt install muscle For usearch, you first need to download it here: usearch (tested with version v10.0.240) Next, you will have to rename it and make it accessible from anywhere in your system: # rename to usearch mv usearchXX.X.XXX_i86xxxx.gz usearch # make usearch executable chmod +x usearch # make usearch easily accessible mkdir ~/bin mv usearch ~/bin Finally, copy the following line in your .bashrc file (or .bash_profile for macos users) export PATH=$PATH:~/bin","title":"External dependencies"},{"location":"installation.html#create-an-isolated-environment","text":"Although not indispensable, this step is highly recommended (it will allow you to work on different projects avoiding potential conflicts between different versions of some python libraries).","title":"Create an isolated environment"},{"location":"installation.html#install-virtualenv","text":"python3 -m pip install virtualenv","title":"Install virtualenv"},{"location":"installation.html#create-a-virtual-python3-environment","text":"virtualenv -p python3 my_env","title":"Create a virtual python3 environment"},{"location":"installation.html#activate-the-created-environment","text":"source my_env/bin/activate Once activated, any python library you'll install using pip will be installed solely in this isolated environment. Every time you'll need to work with libraries installed in this environment (i.e. work on your project), you'll have to activate it. Once you're done working on your project, simply type deactivate to exit the environment.","title":"Activate the created environment"},{"location":"installation.html#download-and-install-the-latest-release-of-cusprose","text":"Click here for the latest release:","title":"Download and install the latest release of CusProSe"},{"location":"installation.html#uncompress-the-archive","text":"If you downloaded the .zip file: unzip cusProSe-x.x.x.zip If you downloaded the .tar.gz file: tar xzvf cusProSe-x.x.x.tar.gz","title":"Uncompress the archive"},{"location":"installation.html#go-to-the-cusprose-directory","text":"cd cusProSe-x.x.x/","title":"Go to the cusProSe directory"},{"location":"installation.html#install-cusprose-on-your-virtual-environment","text":"Make sure your virtual environment is activated and type the following command: python setup.py install or pip install . Note If the installation successfully worked, then typing: iterhmmbuild should display: usage: iterhmmbuild [-h] -fa [FA] -protdb [PROTDB] [-name [NAME]] [-out [OUT]] [-id ID] [-cov COV] [-cval CVAL] [-ival IVAL] [-acc ACC] prosecda should display: usage: prosecda [-h] -proteome [PROTEOME] -hmmdb [HMMDB] -rules [RULES] [-out [OUT]] [-cov COV] [-cval CVAL] [-ival IVAL] [-score SCORE] [-acc ACC] [-pdf] create_hmmdb should display: usage: create_hmmdb [-h] -hmmdir [HMMDIR] [-dbname [DBNAME]] [-outdir [OUTDIR]]","title":"Install CusProSe on your virtual environment"},{"location":"psd_introduction.html","text":"ProSeCDA Overall procedure # Figure 2: Pipeline overview of ProSeCDA ProSeCDA is a tool that allows to search in a given protein database multiple proteins of interest defined by a user-specified set of domains. The first step in ProSeCDA is to annotate a protein database of interest with domains from a user-specified HMM profile database. In the next step the annotated proteins are filtered following a set of rules defined by the user. The rule consists to define one or a set of protein families based on the presence and/or absence of domains. All proteins matching thoses rules are then finally accessible in the output. Inputs # ProSeCDA requires three inputs: a protein database in a fasta format in which the user wants to search proteins of interest based on their domain architecture. an HMM domain profile database used to annotate the input protein database. Any HMM domain profile database can be used as long as it is compatible with hmmersearch. a YAML file containing the rules, that is a set of protein families defined by the presence and/or absence of specific domain(s). The format of the YAML file is described in Usage guideline . Please note that domains used to define proteins on interest must be present in the HMM domain profile database. Annotation # Selection of matching domains # The annotation step is required to assign domains from the HMM profile database matching sequences in the protein database. The annotation procedure uses hmmsearch to search for each of the HMM domain profile present in the YAML rules file against the protein database of interest. All matching sequences with an E-values a less than 0.01 (default value) and an expected accuracy per residue of the alignment b above or equal to 0.6 (default value) are then retrieved. Note a Both conditional and independent E-values from hmmer are evaluated b Please see the hmmer documentation for more details about the accuracy Resolving overlapping domains # To resolve overlapping domains a , an approach similar to the heaviest weighted clique-finding method described in Orengo et al. is used. When multiple matching domains are found for a protein sequence and some of those domains overlap, all possible domain architectures defined by a set of non-overlapping domains are identified, with each domain being assigned a score corresponding to -log(E-value). An alternative score is also used in case the E-value associated with a match is equal to 0.0. In that case, the bit score from hmmer is assigned to each domain instead of the -log(E-value) which cannot be computed. The protein is then assigned the most-likely domain architecture which is defined as the combination of non-overlapping domains that gives the highest total score. Note a We consider that two domains are overlapping if at least 40% of the shortest domain sequence overlap with the other domain. Filtering # The filtering step searches in all precedently annotated proteins the domain architectures matching those in the set of rules defined by the user. A match with a user-defined family is valid for a protein if its most-likely domain architecture fits the mandatory domains and if no forbidden domains are present. Moreover, if an E-value threshold is specified in the rules for a given mandatory domain, this domain must match with an E-value at least below this threshold. Output # The output of ProSeCDA has the following architecture: prosecda_yyyy-mm-dd_hh-mm-ss/ \u251c\u2500\u2500 protein_database_filename.domtblout \u251c\u2500\u2500 info.log \u2514\u2500\u2500 results/ \u251c\u2500\u2500 family_A1/ \u2502 \u251c\u2500\u2500 all_matching_proteins.pdf \u2502 \u251c\u2500\u2500 protein_id_1.fa \u2502 \u251c\u2500\u2500 protein_id_1.pdf \u2502 \u251c\u2500\u2500 protein_id_1.xml \u2502 \u251c\u2500\u2500 protein_id_2.fa \u2502 \u251c\u2500\u2500 protein_id_2.pdf \u2502 \u2514\u2500\u2500 protein_id_2.xml \u251c\u2500\u2500 family_A2/ \u2502 \u251c\u2500\u2500 all_matching_proteins.pdf \u2502 \u251c\u2500\u2500 protein_id_8.fa \u2502 \u251c\u2500\u2500 protein_id_8.pdf \u2502 \u251c\u2500\u2500 protein_id_8.xml \u2502 \u2514\u2500\u2500 ... \u251c\u2500\u2500 ... The table below describes the content of the output directory: File/Directory name Description protein_database_filename.domtblout hmmsearch output in domtblout format info.log Summary log of the computation family_A1/ Subdirectory containing detailed files for proteins matching the rule defining 'family A1' all_matching_proteins.pdf Figures of all proteins matching the family rule with their most-likely domain architecture protein_id_1.fa Fasta sequence of the protein protein_id_1.pdf Figure of the protein with all matching domains protein_id_1.xml XML file describing the protein","title":"Overall procedure"},{"location":"psd_introduction.html#prosecda-overall-procedure","text":"Figure 2: Pipeline overview of ProSeCDA ProSeCDA is a tool that allows to search in a given protein database multiple proteins of interest defined by a user-specified set of domains. The first step in ProSeCDA is to annotate a protein database of interest with domains from a user-specified HMM profile database. In the next step the annotated proteins are filtered following a set of rules defined by the user. The rule consists to define one or a set of protein families based on the presence and/or absence of domains. All proteins matching thoses rules are then finally accessible in the output.","title":"ProSeCDA Overall procedure"},{"location":"psd_introduction.html#inputs","text":"ProSeCDA requires three inputs: a protein database in a fasta format in which the user wants to search proteins of interest based on their domain architecture. an HMM domain profile database used to annotate the input protein database. Any HMM domain profile database can be used as long as it is compatible with hmmersearch. a YAML file containing the rules, that is a set of protein families defined by the presence and/or absence of specific domain(s). The format of the YAML file is described in Usage guideline . Please note that domains used to define proteins on interest must be present in the HMM domain profile database.","title":"Inputs"},{"location":"psd_introduction.html#annotation","text":"","title":"Annotation"},{"location":"psd_introduction.html#selection-of-matching-domains","text":"The annotation step is required to assign domains from the HMM profile database matching sequences in the protein database. The annotation procedure uses hmmsearch to search for each of the HMM domain profile present in the YAML rules file against the protein database of interest. All matching sequences with an E-values a less than 0.01 (default value) and an expected accuracy per residue of the alignment b above or equal to 0.6 (default value) are then retrieved. Note a Both conditional and independent E-values from hmmer are evaluated b Please see the hmmer documentation for more details about the accuracy","title":"Selection of matching domains"},{"location":"psd_introduction.html#resolving-overlapping-domains","text":"To resolve overlapping domains a , an approach similar to the heaviest weighted clique-finding method described in Orengo et al. is used. When multiple matching domains are found for a protein sequence and some of those domains overlap, all possible domain architectures defined by a set of non-overlapping domains are identified, with each domain being assigned a score corresponding to -log(E-value). An alternative score is also used in case the E-value associated with a match is equal to 0.0. In that case, the bit score from hmmer is assigned to each domain instead of the -log(E-value) which cannot be computed. The protein is then assigned the most-likely domain architecture which is defined as the combination of non-overlapping domains that gives the highest total score. Note a We consider that two domains are overlapping if at least 40% of the shortest domain sequence overlap with the other domain.","title":"Resolving overlapping domains"},{"location":"psd_introduction.html#filtering","text":"The filtering step searches in all precedently annotated proteins the domain architectures matching those in the set of rules defined by the user. A match with a user-defined family is valid for a protein if its most-likely domain architecture fits the mandatory domains and if no forbidden domains are present. Moreover, if an E-value threshold is specified in the rules for a given mandatory domain, this domain must match with an E-value at least below this threshold.","title":"Filtering"},{"location":"psd_introduction.html#output","text":"The output of ProSeCDA has the following architecture: prosecda_yyyy-mm-dd_hh-mm-ss/ \u251c\u2500\u2500 protein_database_filename.domtblout \u251c\u2500\u2500 info.log \u2514\u2500\u2500 results/ \u251c\u2500\u2500 family_A1/ \u2502 \u251c\u2500\u2500 all_matching_proteins.pdf \u2502 \u251c\u2500\u2500 protein_id_1.fa \u2502 \u251c\u2500\u2500 protein_id_1.pdf \u2502 \u251c\u2500\u2500 protein_id_1.xml \u2502 \u251c\u2500\u2500 protein_id_2.fa \u2502 \u251c\u2500\u2500 protein_id_2.pdf \u2502 \u2514\u2500\u2500 protein_id_2.xml \u251c\u2500\u2500 family_A2/ \u2502 \u251c\u2500\u2500 all_matching_proteins.pdf \u2502 \u251c\u2500\u2500 protein_id_8.fa \u2502 \u251c\u2500\u2500 protein_id_8.pdf \u2502 \u251c\u2500\u2500 protein_id_8.xml \u2502 \u2514\u2500\u2500 ... \u251c\u2500\u2500 ... The table below describes the content of the output directory: File/Directory name Description protein_database_filename.domtblout hmmsearch output in domtblout format info.log Summary log of the computation family_A1/ Subdirectory containing detailed files for proteins matching the rule defining 'family A1' all_matching_proteins.pdf Figures of all proteins matching the family rule with their most-likely domain architecture protein_id_1.fa Fasta sequence of the protein protein_id_1.pdf Figure of the protein with all matching domains protein_id_1.xml XML file describing the protein","title":"Output"},{"location":"psd_usage.html","text":"ProSeCDA usage guideline # This tool allows you to detect in a proteome proteins matching specific given domain architectures rules. Inputs # Three input files are required: a protein database in a fasta format the user wants to scan to identify proteins of interests an HMM domain profile database use to annotate proteins a YAML file in which proteins of interest are described based on the presence/absence of specific domains Rules creation to model proteins of interest # The proteins the user is interested in must be described in a file containing simple rules defining for each protein of interest which domains are mandatory and/or which one are forbidden. An E-value (corresponding to the independent domain E-value from hmmsearch) can also be specified for each mandatory domains. In that case, a mandatory domain must match a sequence with an E-value at least below the one specified. If no E-value is defined for mandatory domains, an E-value of 0.01 is used by default. Edit rules from GUI # The file in which rules are edited must respect a specific syntax in a YAML format. To make it simpler, a Graphical User Interface (GUI) has been implemented. You can access it through the command create_rules Figure 3: Graphical User Interface to edit rules As shown in the above image, a rule can be defined by five different inputs: Name (required): category/family name the proteins that'll match the rule will be assigned to Comment (optional): can be used to describe the rule Mandatory (required): domain name the protein must contain E-value (optional): minimal E-value the associated domain must match a sequence (0.01 if not specified) Forbidden (optional): domain name the protein must not contain Once you have added all your mandatory/forbidden domains describing the domain architecture your proteins of interest must match, click on Add rule to the list to validate the rule. You'll see it listed in the 'Rule list' panel. Repeat the procedure to create as many rules as you want. Once all your desired rules are defined, click on Save rules to save them in a YAML file. This YAML file will look like the one described below: PKS: COMMENT: Polyketide Synthase CONDITION: mandatory: - KS - AT - PP-binding, 0.0001 forbidden: - C PKS-like: COMMENT: Polyketide Synthase like CONDITION: mandatory: - KS - AT forbidden: PKS_type3.0: COMMENT: Polyketide Syntase type III CONDITION: mandatory: - CHS_like forbidden: Running ProSeCDA # Input examples are available in cusProSe-x.x.x/prosecda/datas/ The command below will search in the f. fujikuroi proteomes all proteins matching the rules defined in rules.yaml from the HMM profile database databaseKGall_terpenes_selec.hmm: run_prosecda -proteome fusarium_fujikuroi_IMI58289_V2_protein.fasta -hmmdb databaseKGall_terpenes_selec.hmm -rules rules.yaml Output of ProSeCDA # Global architecture # An output directory will be generated in a generic format: prosecda_year-month-day_hour-min-sec/ This directory content will be like the one below: prosecda_2020-10-29_15-55-24/ \u251c\u2500\u2500 fusarium_fujikuroi_IMI58289_V2_protein.domtblout \u251c\u2500\u2500 info.log \u2514\u2500\u2500 matches/ with: fusarium_fujikuroi_IMI58289_V2_protein.domtblout : output file of hmmsearch matches/ : directory containing different output files for rules matching proteins The content of matches/ directory is as follow: matches/ \u251c\u2500\u2500 DMATS/ \u2502 \u251c\u2500\u2500 XP_023429775.1.fa \u2502 \u251c\u2500\u2500 XP_023429775.1.xml \u2502 \u251c\u2500\u2500 XP_023436063.1.fa \u2502 \u2514\u2500\u2500 XP_023436063.1.xml \u251c\u2500\u2500 DMATS.pdf \u251c\u2500\u2500 Ent_kaurene_synthase/ \u2502 \u251c\u2500\u2500 XP_023431478.1.fa \u2502 \u2514\u2500\u2500 XP_023431478.1.xml \u251c\u2500\u2500 Ent_kaurene_synthase.pdf \u251c\u2500\u2500 NRPS-PKS/ \u2502 \u251c\u2500\u2500 XP_023427367.1.fa \u2502 \u251c\u2500\u2500 XP_023427367.1.xml \u2502 \u251c\u2500\u2500 XP_023429959.1.fa \u2502 \u251c\u2500\u2500 XP_023429959.1.xml \u2502 \u251c\u2500\u2500 XP_023434892.1.fa \u2502 \u251c\u2500\u2500 XP_023434892.1.xml \u2502 \u251c\u2500\u2500 XP_023435338.1.fa \u2502 \u2514\u2500\u2500 XP_023435338.1.xml \u2514\u2500\u2500 NRPS-PKS.pdf with: DMATS, Ent_kaurene_synthase and NRPS-PKS: subdirectories containing output files for proteins matching the given rule protein.fa: protein sequence in fasta file format protein.xml: informations about the protein and its domain(s) pdf files: graphical representation of the most likely domain architecture of the protein PDF files # Example of the output pdf file for XP_023431478.1 in NRPS-PKS: Output XML file # <protein> <id>XP_023431478.1</id> <sequence_length>952</sequence_length> <class_name>Ent_kaurene_synthase</class_name> <domain_architecture> <domain name=\"ent_kaurene\"> <cval>0.0</cval> <ival>0.0</ival> <score>1074.3</score> <start>10</start> <end>952</end> <domain_length>943</domain_length> </domain> </domain_architecture> </protein>","title":"Usage guideline"},{"location":"psd_usage.html#prosecda-usage-guideline","text":"This tool allows you to detect in a proteome proteins matching specific given domain architectures rules.","title":"ProSeCDA usage guideline"},{"location":"psd_usage.html#inputs","text":"Three input files are required: a protein database in a fasta format the user wants to scan to identify proteins of interests an HMM domain profile database use to annotate proteins a YAML file in which proteins of interest are described based on the presence/absence of specific domains","title":"Inputs"},{"location":"psd_usage.html#rules-creation-to-model-proteins-of-interest","text":"The proteins the user is interested in must be described in a file containing simple rules defining for each protein of interest which domains are mandatory and/or which one are forbidden. An E-value (corresponding to the independent domain E-value from hmmsearch) can also be specified for each mandatory domains. In that case, a mandatory domain must match a sequence with an E-value at least below the one specified. If no E-value is defined for mandatory domains, an E-value of 0.01 is used by default.","title":"Rules creation to model proteins of interest"},{"location":"psd_usage.html#edit-rules-from-gui","text":"The file in which rules are edited must respect a specific syntax in a YAML format. To make it simpler, a Graphical User Interface (GUI) has been implemented. You can access it through the command create_rules Figure 3: Graphical User Interface to edit rules As shown in the above image, a rule can be defined by five different inputs: Name (required): category/family name the proteins that'll match the rule will be assigned to Comment (optional): can be used to describe the rule Mandatory (required): domain name the protein must contain E-value (optional): minimal E-value the associated domain must match a sequence (0.01 if not specified) Forbidden (optional): domain name the protein must not contain Once you have added all your mandatory/forbidden domains describing the domain architecture your proteins of interest must match, click on Add rule to the list to validate the rule. You'll see it listed in the 'Rule list' panel. Repeat the procedure to create as many rules as you want. Once all your desired rules are defined, click on Save rules to save them in a YAML file. This YAML file will look like the one described below: PKS: COMMENT: Polyketide Synthase CONDITION: mandatory: - KS - AT - PP-binding, 0.0001 forbidden: - C PKS-like: COMMENT: Polyketide Synthase like CONDITION: mandatory: - KS - AT forbidden: PKS_type3.0: COMMENT: Polyketide Syntase type III CONDITION: mandatory: - CHS_like forbidden:","title":"Edit rules from GUI"},{"location":"psd_usage.html#running-prosecda","text":"Input examples are available in cusProSe-x.x.x/prosecda/datas/ The command below will search in the f. fujikuroi proteomes all proteins matching the rules defined in rules.yaml from the HMM profile database databaseKGall_terpenes_selec.hmm: run_prosecda -proteome fusarium_fujikuroi_IMI58289_V2_protein.fasta -hmmdb databaseKGall_terpenes_selec.hmm -rules rules.yaml","title":"Running ProSeCDA"},{"location":"psd_usage.html#output-of-prosecda","text":"","title":"Output of ProSeCDA"},{"location":"psd_usage.html#global-architecture","text":"An output directory will be generated in a generic format: prosecda_year-month-day_hour-min-sec/ This directory content will be like the one below: prosecda_2020-10-29_15-55-24/ \u251c\u2500\u2500 fusarium_fujikuroi_IMI58289_V2_protein.domtblout \u251c\u2500\u2500 info.log \u2514\u2500\u2500 matches/ with: fusarium_fujikuroi_IMI58289_V2_protein.domtblout : output file of hmmsearch matches/ : directory containing different output files for rules matching proteins The content of matches/ directory is as follow: matches/ \u251c\u2500\u2500 DMATS/ \u2502 \u251c\u2500\u2500 XP_023429775.1.fa \u2502 \u251c\u2500\u2500 XP_023429775.1.xml \u2502 \u251c\u2500\u2500 XP_023436063.1.fa \u2502 \u2514\u2500\u2500 XP_023436063.1.xml \u251c\u2500\u2500 DMATS.pdf \u251c\u2500\u2500 Ent_kaurene_synthase/ \u2502 \u251c\u2500\u2500 XP_023431478.1.fa \u2502 \u2514\u2500\u2500 XP_023431478.1.xml \u251c\u2500\u2500 Ent_kaurene_synthase.pdf \u251c\u2500\u2500 NRPS-PKS/ \u2502 \u251c\u2500\u2500 XP_023427367.1.fa \u2502 \u251c\u2500\u2500 XP_023427367.1.xml \u2502 \u251c\u2500\u2500 XP_023429959.1.fa \u2502 \u251c\u2500\u2500 XP_023429959.1.xml \u2502 \u251c\u2500\u2500 XP_023434892.1.fa \u2502 \u251c\u2500\u2500 XP_023434892.1.xml \u2502 \u251c\u2500\u2500 XP_023435338.1.fa \u2502 \u2514\u2500\u2500 XP_023435338.1.xml \u2514\u2500\u2500 NRPS-PKS.pdf with: DMATS, Ent_kaurene_synthase and NRPS-PKS: subdirectories containing output files for proteins matching the given rule protein.fa: protein sequence in fasta file format protein.xml: informations about the protein and its domain(s) pdf files: graphical representation of the most likely domain architecture of the protein","title":"Global architecture"},{"location":"psd_usage.html#pdf-files","text":"Example of the output pdf file for XP_023431478.1 in NRPS-PKS: Output","title":"PDF files"},{"location":"psd_usage.html#xml-file","text":"<protein> <id>XP_023431478.1</id> <sequence_length>952</sequence_length> <class_name>Ent_kaurene_synthase</class_name> <domain_architecture> <domain name=\"ent_kaurene\"> <cval>0.0</cval> <ival>0.0</ival> <score>1074.3</score> <start>10</start> <end>952</end> <domain_length>943</domain_length> </domain> </domain_architecture> </protein>","title":"XML file"}]}